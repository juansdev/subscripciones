<p align="center">
  <img src="https://raw.githubusercontent.com/PKief/vscode-material-icon-theme/ec559a9f6bfd399b82bb44393651661b08aaf7ba/icons/folder-markdown-open.svg" width="100" alt="project-logo">
</p>
<p align="center">
    <h1 align="center">SUBSCRIPCIONES</h1>
</p>
<p align="center">
    <em>Manage Your Writers Universe with WebAPIAutores!With its robust architecture and intuitive interface, our WebAPIAutores solution empowers you to harness the limitless potential of author subscriptions. Leveraging ASP.NET Core web API services and Azure, this streamlined system offers seamless integration and a user-friendly experience. Join us on a thrilling journey through the literary landscape! üåêüöÄ</em>
</p>
<p align="center">
	<img src="https://img.shields.io/github/license/juansdev/subscripciones?style=default&logo=opensourceinitiative&logoColor=white&color=0080ff" alt="license">
	<img src="https://img.shields.io/github/last-commit/juansdev/subscripciones?style=default&logo=git&logoColor=white&color=0080ff" alt="last-commit">
	<img src="https://img.shields.io/github/languages/top/juansdev/subscripciones?style=default&color=0080ff" alt="repo-top-language">
	<img src="https://img.shields.io/github/languages/count/juansdev/subscripciones?style=default&color=0080ff" alt="repo-language-count">
<p>
<p align="center">
	<!-- default option, no dependency badges. -->
</p>

<br><!-- TABLE OF CONTENTS -->
<details>
  <summary>Table of Contents</summary><br>

- [ Overview](#-overview)
- [ Features](#-features)
- [ Repository Structure](#-repository-structure)
- [ Modules](#-modules)
- [ Getting Started](#-getting-started)
  - [ Installation](#-installation)
  - [ Usage](#-usage)
  - [ Tests](#-tests)
</details>
<hr>

##  Overview

The software project in question, named WebAPIAutores, is a robust ASP.NET Core application designed for efficient author management across multiple platforms. Its centralized solution file, `WebAPIAutores.sln`, orchestrates various projects, including web API services, data access layers, and utilities, within a unified architecture (Any CPU).At its core lies the WebAPIAutores/WebAPIAutores.csproj project, which focuses on configuring an author subscription-centric RESTful web API service. Leveraging.NET version 6.0 and essential packages such as AutoMapper, JwtBearer authentication, EntityFrameworkCore, Swashbuckle.AspNetCore, and NewtonsoftJson for model serialization, it streamlines the development of a comprehensive author subscription management system. The project's folder structure is organized judiciously, fostering smooth development, testing, and deployment processes.Key configuration details reside in the WebAPIAutores/appsettings.json' file, ensuring default logging settings at the Information level while filtering warnings from Microsoft and hosting-related information. It also accommodates any host and sets the connection string for an Azure database named CursoWebApis to manage application data securely. This open-source project delivers exceptional value by offering a scalable, cross-platform solution for managing authors and their subscriptions in a modern, secure manner.

---

##  Features

| Feature         | Description                                                                                                               |
|-------------------|---------------------------------------------------------------------------------------------------------------------------|
| **Architecture**  | Solution file `WebAPIAutores.sln` orchestrates ASP.NET Core web API, data access, and utility projects for author management.   |
| **Code Quality**  | C# codebase is clean with proper use of comments, variable/function naming conventions, and adheres to .NET guidelines.         |
| **Documentation** | Documentation exists in the form of project and file readme's but is sparse. More comprehensive documentation would improve UX.|
| **Integrations**  | AutoMapper, JwtBearer authentication, EntityFrameworkCore, Swashbuckle.AspNetCore, and NewtonsoftJson for better development.     |
| **Modularity**    | Well-organized folder structure optimally organizes controllers, models, services, middlewares, etc., enhancing maintainability.  |
| **Testing**       | Uses MSTest as the testing framework to ensure proper unit and integration tests are implemented.                               |
| **Performance**   | Efficiently built using .NET 6, but no explicit evaluation of efficiency or speed is provided. Resource usage is manageable.  |
| **Security**      | Implements authentication via JwtBearer and data protection with Azure server connections and rate limiting on API requests.    |
| **Dependencies**  | Uses various external libraries such as `html`, `csproj`, `txt`, `text`, `csharp`, `sln`, `json`, `cs`, `AutoMapper`, JwtBearer, EFCore, Swashbuckle, and NewtonsoftJson.                      |

---

##  Repository Structure

```sh
‚îî‚îÄ‚îÄ subscripciones/
    ‚îú‚îÄ‚îÄ WebAPIAutores
    ‚îÇ   ‚îú‚îÄ‚îÄ .gitignore
    ‚îÇ   ‚îú‚îÄ‚îÄ ApplicationDbContext.cs
    ‚îÇ   ‚îú‚îÄ‚îÄ Controllers
    ‚îÇ   ‚îú‚îÄ‚îÄ DTOs
    ‚îÇ   ‚îú‚îÄ‚îÄ Entidades
    ‚îÇ   ‚îú‚îÄ‚îÄ Filtros
    ‚îÇ   ‚îú‚îÄ‚îÄ Middlewares
    ‚îÇ   ‚îú‚îÄ‚îÄ Migrations
    ‚îÇ   ‚îú‚îÄ‚îÄ Program.cs
    ‚îÇ   ‚îú‚îÄ‚îÄ Properties
    ‚îÇ   ‚îú‚îÄ‚îÄ Servicios
    ‚îÇ   ‚îú‚îÄ‚îÄ Startup.cs
    ‚îÇ   ‚îú‚îÄ‚îÄ Utilidades
    ‚îÇ   ‚îú‚îÄ‚îÄ Validaciones
    ‚îÇ   ‚îú‚îÄ‚îÄ WebAPIAutores.csproj
    ‚îÇ   ‚îú‚îÄ‚îÄ appsettings.Development.json
    ‚îÇ   ‚îú‚îÄ‚îÄ appsettings.json
    ‚îÇ   ‚îú‚îÄ‚îÄ prueba.html
    ‚îÇ   ‚îî‚îÄ‚îÄ wwwroot
    ‚îî‚îÄ‚îÄ WebAPIAutores.sln
```

---

##  Modules

<details closed><summary>.</summary>

| File                                                                                          | Summary                                                                                                                                                                                                                                                                                                                                                                         |
| ---                                                                                           | ---                                                                                                                                                                                                                                                                                                                                                                             |
| [WebAPIAutores.sln](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores.sln) | This solution file, `WebAPIAutores.sln`, serves as the blueprint for a Visual Studio project named WebAPIAutores. It aggregates various projects under a unified architecture, such as ASP.NET Core web API services, data access, and utilities, facilitating efficient development of an application focused on authors management in a multi-platform environment (Any CPU). |

</details>

<details closed><summary>WebAPIAutores</summary>

| File                                                                                                                              | Summary                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ---                                                                                                                               | ---                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [WebAPIAutores.csproj](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/WebAPIAutores.csproj)                 | This project file configures a web API for author subscriptions. It specifies.NET version 6.0, and integrates necessary packages such as AutoMapper, JwtBearer authentication, EntityFrameworkCore, Swashbuckle.AspNetCore, and NewtonsoftJson for model serialization. The folder structure is designed to optimally organize controllers, models, services, middlewares, etc., facilitating development, testing, and deployment of the author subscription web API application. |
| [appsettings.json](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/appsettings.json)                         | Sets default log level to Information, filters warnings from Microsoft and hosting lifetime. 2. Allows any host (*). 3. Defines database connection string to Azure server for application database, CursoWebApis. 4. Implements rate limiting on petitions per day, up to 20 gratuitous requests and a whitelist of paths.                                                                                                                                                        |
| [prueba.html](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/prueba.html)                                   | Frontend interface file for WebAPIAutores initiates data retrieval from API endpoint (/api/autores). It employs JavaScript fetch method and passes authentication token as X-Api-Key header, enabling the frontend to request data from the backend service. This simplifies interactions with the autores database, ultimately improving user experience.                                                                                                                         |
| [Startup.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Startup.cs)                                     | Sets up services, authentication with JWT, Swagger documentation, Identity management, authorization policies, AutoMapper, Data Protection, and logging middleware. Uses CORS and rate limiting for security measures. Implements a hosted service for handling asynchronous tasks like generating hashes and sending invoices.                                                                                                                                                    |
| [Program.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Program.cs)                                     | Initializes a web application for managing author subscriptions. The Program file is responsible for building the application and setting up its services using the Startup configuration and dependency injection. This forms the foundation of our REST API service within the wider subscripciones repository architecture, serving as the entry point when launching the application.                                                                                          |
| [ApplicationDbContext.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/ApplicationDbContext.cs)           | This C# context file in our WebAPIAutores project defines data models for the application, enabling interaction with database tables like Autor, Libro, Comentario, and others. It manages relationships such as AutorLibro (connecting authors and books) and Factura (invoices), providing a critical link between the API and its data storage.                                                                                                                                 |
| [appsettings.Development.json](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/appsettings.Development.json) | Sets logging level to Information" for easier debugging.-Establishes local SQL Server connection string.-Defines JWT secret key for authentication purposes.-Limits daily free requests to 20.                                                                                                                                                                                                                                                                                     |

</details>

<details closed><summary>WebAPIAutores.Middlewares</summary>

| File                                                                                                                                                                  | Summary                                                                                                                                                                                                                                                           |
| ---                                                                                                                                                                   | ---                                                                                                                                                                                                                                                               |
| [LoguearRespuestaHTTPMiddleware.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Middlewares/LoguearRespuestaHTTPMiddleware.cs)               | Tracks HTTP responses in the WebAPIAutores application by temporarily rerouting response bodies through a memory stream, logging the contents for later review and troubleshooting. Streamlined diagnostics to ensure seamless service performance.               |
| [LimitarPeticionesMiddlewareExtensions.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Middlewares/LimitarPeticionesMiddlewareExtensions.cs) | Verifies daily petition limit and user status before adding petitions to the database. Implements separate functions for checking IP and domain restrictions. Returns appropriate HTTP response codes based on results, such as Too many requests' or Bad debtor. |

</details>

<details closed><summary>WebAPIAutores.Entidades</summary>

| File                                                                                                                          | Summary                                                                                                                                                                                                                                                                                                                                                                                                      |
| ---                                                                                                                           | ---                                                                                                                                                                                                                                                                                                                                                                                                          |
| [Factura.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Entidades/Factura.cs)                       | In the WebAPIAutores repository, the Factura class organizes crucial billing information for each user, such as their ID, payment status, total amount, issue and expiry dates. Integrated with Usuario entity, it facilitates easy tracking of payments in the system.                                                                                                                                      |
| [Comentario.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Entidades/Comentario.cs)                 | Manages `Comentario` entities in the `WebAPIAutores`, storing user comments related to specific books. This class establishes connections between comments, users, and corresponding books, enriching interaction within the application.                                                                                                                                                                    |
| [LlaveAPI.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Entidades/LlaveAPI.cs)                     | Manages authentication keys for user access. Key class contains attributes like Id, Llave, Type (Gratuita/Professional), activates flag, UsuarioId, and lists of domain restrictions and IP restrictions for secure access management.                                                                                                                                                                       |
| [FacturaEmitida.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Entidades/FacturaEmitida.cs)         | Empowers**-This file encapsulates the FacturaEmitida entity within the WebAPIAutores architecture. It structures financial transaction data (Mes & A√±o), providing the framework for managing and recording monthly billings. Integral to financial tracking, it ensures seamless accountability.                                                                                                            |
| [RestriccionDominio.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Entidades/RestriccionDominio.cs) | Manages domain restrictions within the subscription APIs entity structure. The `RestriccionDominio` class defines an entity with `Id`, `LlaveId`, `Dominio`, and a referential association to the `LlaveAPI`. This helps in restricting and validating API requests based on their source domain within the overall architecture.                                                                            |
| [Libro.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Entidades/Libro.cs)                           | Manage literary resources efficiently. Critical Entities class `Libro` encapsulates book details such as title, publication date, and relationships with authors and comments in the WebAPIAutores project structure. Validates title with first character capitalized and within specified length limit, promoting structured data handling for bibliographical applications.                               |
| [Usuario.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Entidades/Usuario.cs)                       | Empowers user management within the Subscripciones repository by introducing the `Usuario` entity, an extension of `IdentityUser`. This entity includes the `MalaPaga` attribute, allowing tracking of payment issues for individual users.                                                                                                                                                                  |
| [Autor.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Entidades/Autor.cs)                           | In this repository structure, `Autor.cs` defines an entity class called `Autor`. This class is central to managing author data within the `WebAPIAutores` application. Each instance of the class represents an author, with attributes such as Id and Nombre. The `AutoresLibros` property maintains associations between authors and their books, thus linking authors and the literary works they create. |
| [AutorLibro.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Entidades/AutorLibro.cs)                 | Model** for the composite relationship between `Authors` and their associated `Books`. This model allows tracking of each authors involvement in multiple books and helps organize them in a sequential order (using the `Orden` field) within a single book entity, enhancing data consistency within the Autores WebAPI.                                                                                   |
| [RestriccionIP.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Entidades/RestriccionIP.cs)           | Manages IP restrictions in this web API for authors service. The RestriccionIP class encapsulates each IP address with its unique id and associates it with a key from the LlaveAPI entity, streamlining access control within our application architecture.                                                                                                                                                 |
| [Peticion.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Entidades/Peticion.cs)                     | Manage petitions efficiently by defining and storing their details, including ID, timestamp, and associated API key. The Peticion entity serves as a foundation within the WebAPIAutores application for tracking petition requests, ensuring smooth operations across various APIs.                                                                                                                         |

</details>

<details closed><summary>WebAPIAutores.wwwroot</summary>

| File                                                                                                        | Summary                                                                                                                                                                                                                                                                    |
| ---                                                                                                         | ---                                                                                                                                                                                                                                                                        |
| [Archivo 1.txt](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/wwwroot/Archivo 1.txt) | Monitors and logs the status of long-running processes within the WebAPIAutores application. Provides real-time updates, timestamps, and indicates when a process is completed. Integral for managing time-consuming tasks efficiently, enhancing application performance. |

</details>

<details closed><summary>WebAPIAutores.Filtros</summary>

| File                                                                                                                      | Summary                                                                                                                                                                            |
| ---                                                                                                                       | ---                                                                                                                                                                                |
| [FiltroDeExcepcion.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Filtros/FiltroDeExcepcion.cs) | Monitors and handles exceptions for the WebAPIAutores application, logging errors effectively and ensuring a seamless user experience by preventing potential application crashes. |

</details>

<details closed><summary>WebAPIAutores.Migrations</summary>

| File                                                                                                                                                                                 | Summary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ---                                                                                                                                                                                  | ---                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [20230711193422_Llaves.Designer.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20230711193422_Llaves.Designer.cs)                               | IdentityUser and its related entities like Login, Role, Token are interrelated through foreign keys with OnDelete behavior set to Cascade. 2. Autor and Libro are associated in the AutorLibro entity which represents many-to-many relationship between them. 3. A Comentario is linked to both a Libro (one-to-many) and an Usuario (one-to-many). 4. LlaveAPI has one-to-many association with IdentityUser, and theres a one-to-one relationship between IdentityUser and the rest of the entities mentioned.                                                             |
| [20230712025052_Facturas.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20230712025052_Facturas.cs)                                             | A migration to establish new database tables `Facturas` and `FacturasEmitidas` within the WebAPIAutores database. The Facturas table stores users financial transactions while tracking their payment status, amount, emission date, and deadline. The FacturasEmitidas table categorizes facturas based on month and year for ease of record management.                                                                                                                                                                                                                     |
| [20210604225138_Comentarios.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210604225138_Comentarios.cs)                                       | Introduces table Comentarios for user comments on books in the WebAPIAutores repository, creating foreign key relationship with Libros table and implementing CRUD functionality through Migrations for managing book reviews.                                                                                                                                                                                                                                                                                                                                                |
| [20230711203336_Peticiones.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20230711203336_Peticiones.cs)                                         | Introduces `Peticiones` table in WebAPIAutoress database schema, allowing for petitions to be recorded, referencing relevant keys from the `LlavesAPI`.                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [20210606130933_AutoresLibros.Designer.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210606130933_AutoresLibros.Designer.cs)                 | This Migration file extends `ApplicationDbContext` to create and manage tables for `Autores`, `Libros`, `AutorLibro`, and `Comentario`. Relations between entities are defined, ensuring consistent data integrity within the WebAPIAutores applications database.                                                                                                                                                                                                                                                                                                            |
| [20230712022148_UsuarioMalaPaga.Designer.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20230712022148_UsuarioMalaPaga.Designer.cs)             | Establishes and configures one-to-many relationships between tables in an EF Core model, with cascading deletes and required foreign keys. The Usuario entity is referenced in multiple tables without specifying its associated many collections. Several navigational properties are also set for easier data access.                                                                                                                                                                                                                                                       |
| [20230712022148_UsuarioMalaPaga.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20230712022148_UsuarioMalaPaga.cs)                               | Introduces MalaPaga user attribute, categorizing users with payment issues in WebAPIAutores application, for enhanced user management and subscriptions.                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [20230711193422_Llaves.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20230711193422_Llaves.cs)                                                 | This file, Llaves.cs, within the `WebAPIAutores` project's Migrations folder, sets up and manages a new database table named `LlavesAPI`. It defines keys with their associated properties such as type, activeness, and linked user, aiding in secure authorization processes of the API application.                                                                                                                                                                                                                                                                        |
| [20210604205557_Inicial.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210604205557_Inicial.cs)                                               | This migration sets up two tables-Autores and Libros. The Autores table stores author names for book-related data in the WebAPIAutores application, while the Libros table maintains book titles, providing a basic structure for future entity relationships.                                                                                                                                                                                                                                                                                                                |
| [20210610151744_SistemaUsuarios.Designer.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210610151744_SistemaUsuarios.Designer.cs)             | In this script, entities such as `Libros`, `Autor`, and `Comentario` are mapped with their respective foreign keys using the fluent API. Identity-related entities like `IdentityUserRole` are also defined for ASP.NET Identity integration. Relationships are set up, including one-to-many relationships between an `Autor` and multiple `Libro`, or a `Comentario` associated with a single `Libro`. The model builder ensures foreign key cascade deletion to preserve the data integrity of associated tables.                                                          |
| [20210610151744_SistemaUsuarios.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210610151744_SistemaUsuarios.cs)                               | Creates AspNetUserRoles, AspNetUsers, AspNetUserTokens tables with foreign key relationships. Also creates indexes for various tables like AspNetRoleClaims, AspNetUserClaims, etc. However, if needed, drop all the specified tables and rebuild them from scratch on reversing the migrations.                                                                                                                                                                                                                                                                              |
| [20210610193244_ComentarioUsuario.Designer.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210610193244_ComentarioUsuario.Designer.cs)         | Configures database relationships between ASP.NET Identity models and custom entities in WebAPIAutores application. Enforces cascading delete and required foreign keys, establishing many-to-many relationship between User, Role, and UserRole; one-to-many connections between Autor, Libro, AutorLibro, and Comentario entities.                                                                                                                                                                                                                                          |
| [20230712013320_Restricciones.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20230712013320_Restricciones.cs)                                   | In this migration, database tables `RestriccionesDominio` and `RestriccionesIps` are created, establishing restrictions for domains and IP addresses respectively. This facilitates controlling access to our API by enforcing limits based on domain or IP address. The primary purpose of these tables is to enforce security measures across our WebAPIAutores platform.                                                                                                                                                                                                   |
| [ApplicationDbContextModelSnapshot.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/ApplicationDbContextModelSnapshot.cs)                         | This C# file defines EF Core model relationships for an API project with entities like `Usuario`, `Libro`, `Comentario`, `Factura`, and `LlaveAPI`. It uses fluent API to establish one-to-many and many-to-many relationships. The model ensures foreign key dependencies are properly handled for deletions, while maintaining navigational properties.                                                                                                                                                                                                                     |
| [20230712013320_Restricciones.Designer.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20230712013320_Restricciones.Designer.cs)                 | Defines many-to-many and one-to-one relationships for database tables, ensuring proper foreign key usage, cascading deletes, and navigation properties within C# Entity Framework model for an ASP.NET application.                                                                                                                                                                                                                                                                                                                                                           |
| [20210604205557_Inicial.Designer.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210604205557_Inicial.Designer.cs)                             | Initializes a database structure for a web API about authors and books. Defines Autor and Libro entities, setting their properties and tables within the Autores and Libros respectively, to establish a relationship between the two entities. This facilitates managing authors and their corresponding books efficiently.                                                                                                                                                                                                                                                  |
| [20230711203336_Peticiones.Designer.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20230711203336_Peticiones.Designer.cs)                       | AutorLibro, Comentario, LlaveAPI, Peticion and Identity related ones like IdentityUser, IdentityRole, and IdentityUserRole. It ensures proper cascading deletes, required relationships, and efficient navigation for these relationships within the applications database schema.                                                                                                                                                                                                                                                                                            |
| [20210606130933_AutoresLibros.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210606130933_AutoresLibros.cs)                                   | The `AutoresLibros` migration creates a table for `AutoresLibros` linking authors with books in this web API project, establishing relationships and enabling data organization within the database.                                                                                                                                                                                                                                                                                                                                                                          |
| [20210606185500_FechaPublicacionLibro.Designer.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210606185500_FechaPublicacionLibro.Designer.cs) | Updates database schema to create tables for authors, books, comments, and their relationships. Defines entities, properties, and constraints, and configures foreign key relationships within the applications context. Enables database management for an API service dedicated to books and authors.                                                                                                                                                                                                                                                                       |
| [20210604225138_Comentarios.Designer.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210604225138_Comentarios.Designer.cs)                     | This migration script adds a Comentarios table to the database within the WebAPIAutores application. It defines relationships with Autor, Libro, and their corresponding tables, establishing a many-to-many association between Comentarios, Libros, and Autores through foreign keys and on delete behavior.                                                                                                                                                                                                                                                                |
| [20210606185500_FechaPublicacionLibro.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210606185500_FechaPublicacionLibro.cs)                   | In this `WebAPIAutores` repository, this migration adds or removes a `FechaPublicacion` column to/from the `Libros` table (books) in the database. This enhancement supports timely organization and querying of books based on publication date within the book catalog system.                                                                                                                                                                                                                                                                                              |
| [20210610193244_ComentarioUsuario.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20210610193244_ComentarioUsuario.cs)                           | Introduces user-related column UsuarioId in Comentarios table, establishes an index on this column, and links it with the AspNetUsers table, reinforcing user accountability for comments within this WebAPIAutores application architecture.                                                                                                                                                                                                                                                                                                                                 |
| [20230712025052_Facturas.Designer.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Migrations/20230712025052_Facturas.Designer.cs)                           | In this Entity Framework Core configuration, relationships between tables are established. The Autor entity is related to the Libro table through a many-to-many relationship. The Comentario, Factura, and LlaveAPI entities are also linked to Libro with one-to-many relationships, cascading deletion, and required foreign keys. Multiple tables (RestriccionesDominio, RestriccionesIP) connect with the LlaveAPI table via a has-one-and-through association. The Autor, Libro, and LlaveAPI entities are navigational properties to their corresponding associations. |

</details>

<details closed><summary>WebAPIAutores.DTOs</summary>

| File                                                                                                                                               | Summary                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ---                                                                                                                                                | ---                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [PagarFacturaDto.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/PagarFacturaDto.cs)                                 | Streamlines data transfer for factura payments by defining the PagarFacturaDto structure within the WebAPIAutores project architecture. This DTO encapsulates required FacturaId data, simplifying interaction between service layers and client applications.                                                                                                                                                                      |
| [CrearRestriccionIPDto.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/CrearRestriccionIPDto.cs)                     | Enables creation of IP restrictions in the application by accepting required input data on IP addresses via the `CrearRestriccionIPDto` Data Transfer Object (DTO). This contributes to the overall security framework within the `WebAPIAutores` API project, allowing for the filtering of certain IP addresses as needed.                                                                                                        |
| [RespuestaAutenticacion.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/RespuestaAutenticacion.cs)                   | Authenticates** and manages access within the WebAPIAutores by defining and returning authentication tokens along with expiration timestamps through `RespuestaAutenticacion` class in DTOs directory. Ensures secure user sessions within the application.                                                                                                                                                                         |
| [RestriccionDominioDto.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/RestriccionDominioDto.cs)                     | The RestriccionDominioDto class in the WebAPIAutores DTOs folder streamlines the process by receiving domain data, setting its unique ID, and ensuring it adheres to predefined constraints, contributing to robust data handling in our API architecture.                                                                                                                                                                          |
| [ActualizarLlaveDto.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/ActualizarLlaveDto.cs)                           | Streamlines data transfer between layers for authentication updates by defining ActualizarLlaveDto, a Data Transfer Object within the WebAPIAutores architecture. It carries necessary fields for handling key identification and update activation status.                                                                                                                                                                         |
| [AutorCreacionDTO.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/AutorCreacionDTO.cs)                               | In this DTO file, a data transfer object `AutorCreacionDTO` is defined. This object captures key details such as the name of an author when creating a new one via the applications API. The object follows strict validation rules for string length and first-letter capitalization to ensure high-quality data. Integrated with custom validations to enforce robustness and maintainability within our WebAPIAutores ecosystem. |
| [LibroCreacionDTO.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/LibroCreacionDTO.cs)                               | Incoming data on new book creations from web APIs, validates inputs such as titles with first letter capitalized and within a specified length limit, and assigns list of author Ids to the book for later persistence in the repositorys database.                                                                                                                                                                                 |
| [LimitarPeticionesConfiguracion.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/LimitarPeticionesConfiguracion.cs)   | Regulates API request limitations. Introduces a configurable setup for daily free petitions (`PeticionesPorDiaGratuito`) and whitelist routes (`ListaBlancaRutas`), enhancing resource management within the Autores WebAPI architecture.                                                                                                                                                                                           |
| [EditarAdminDTO.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/EditarAdminDTO.cs)                                   | In this repository for a web API managing authors, `EditarAdminDTO.cs` defines a data transfer object (DTO) for handling email updates as part of the admin management system. This simplifies input validation, ensuring only required emails with valid formats are provided.                                                                                                                                                     |
| [ActualizarRestriccionDominioDto.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/ActualizarRestriccionDominioDto.cs) | Streamline subscription process by defining required domain information. ActualizarRestriccionDominioDto class collects and validates Dominio data in WebAPIAutores RESTful service, enabling seamless handling of domain-related updates.                                                                                                                                                                                          |
| [CrearLlaveDto.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/CrearLlaveDto.cs)                                     | A `CrearLlaveDto` class defines input structure in the WebAPIAutores repository, bridging data from client requests to corresponding types (TipoLlave) stored within Entidades. This process helps ensure consistent, secure key generation.                                                                                                                                                                                        |
| [AutorDTOConLibros.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/AutorDTOConLibros.cs)                             | Introduces a new model AutorDTOConLibros, extending existing AutorDTO by including a list of associated book details through LibroDTO. Enriches data structure for web API's Author resource, providing context for related library content.                                                                                                                                                                                        |
| [ResultadoHash.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/ResultadoHash.cs)                                     | A DTO named `ResultadoHash` within the WebAPIAutores project accepts and returns hashed data along with its salt. This facilitates secure handling of sensitive information throughout the application's API interactions.                                                                                                                                                                                                          |
| [CrearRestriccionesDominioDto.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/CrearRestriccionesDominioDto.cs)       | This file defines `CrearRestriccionesDominioDto`-a Data Transfer Object used for request validation when creating domain-specific restrictions within the subscripciones Repository's WebAPIAutores project. By using this DTO, the application ensures only essential information is submitted and adheres to its strict data requirements.                                                                                        |
| [AutorDTO.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/AutorDTO.cs)                                               | A simplified representation of authors, `AutorDTO`. Critical features: `Id`, a unique identifier; `Nombre` for author's name. In the context of this WebAPIAutores project, these data transfer objects facilitate smooth data exchange between API controllers and external clients or services.                                                                                                                                   |
| [CredencialesUsuario.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/CredencialesUsuario.cs)                         | Manages user credentials through a data transfer object (DTO) named `CredencialesUsuario`. This DTO requires email address and password for authentication within the `WebAPIAutores` application, upholding the security standards and streamlining access control in this web API project.                                                                                                                                        |
| [ComentarioDTO.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/ComentarioDTO.cs)                                     | Data Transfer Object for Comments in WebAPIAutores application. Simplifies transfer of comment content and unique identifier, supporting RESTful APIs interactions.                                                                                                                                                                                                                                                                 |
| [ActualizarRestriccionIPDto.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/ActualizarRestriccionIPDto.cs)           | This DTO facilitates updating IP restriction data, validating essential IP input, enabling robust access control in the system.                                                                                                                                                                                                                                                                                                     |
| [LibroDTO.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/LibroDTO.cs)                                               | The `LibroDTO` class defines the shape for handling book information in the WebAPIAutores application, enabling efficient communication between layers of this ASP.NET Core API. It maps database records to application-friendly objects.                                                                                                                                                                                          |
| [LibroDTOConAutores.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/LibroDTOConAutores.cs)                           | Combines `LibroDTO` object with a list of associated `AutorDTO` instances, providing a comprehensive representation of books along with their respective authors for the WebAPIAutores.                                                                                                                                                                                                                                             |
| [LibroPatchDTO.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/LibroPatchDTO.cs)                                     | Adapts user input for library book updates in our WebAPIAutores solution. The LibroPatchDTO simplifies requests, ensuring title consistency and validates date format for publication dates.                                                                                                                                                                                                                                        |
| [ComentarioCreacionDTO.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/ComentarioCreacionDTO.cs)                     | This `ComentarioCreacionDTO` class within the WebAPIAutores repository structure serves as a Data Transfer Object (DTO) for creating new comments. The critical feature is that it contains a Contenido property, holding the content text of a new comment to be posted in the web API. This facilitates the separation between data presentation and manipulation in our application architecture.                                |
| [RestriccionIPDto.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/RestriccionIPDto.cs)                               | This DTO encapsulates IP address restrictions data, contributing to WebAPIAutores security by managing permitted IPs within its application architecture.                                                                                                                                                                                                                                                                           |
| [LlaveDto.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/DTOs/LlaveDto.cs)                                               | Manage authentication keys with varying types, statuses, and restrictions. Key Features: Handles data objects for user authentication keys (ID, key, status) along with domain-specific (RestriccionDominioDto) and IP-based (RestriccionIPDto) restrictions. Ensures secure and granular access control in the WebAPIAutores ecosystem.                                                                                            |

</details>

<details closed><summary>WebAPIAutores.Validaciones</summary>

| File                                                                                                                                                     | Summary                                                                                                                                                                                                                                                    |
| ---                                                                                                                                                      | ---                                                                                                                                                                                                                                                        |
| [PrimeraLetraMayusculaAttribute.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Validaciones/PrimeraLetraMayusculaAttribute.cs) | Validates and ensures the first character in submitted data is uppercase, maintaining proper formatting for user input within the WebAPIAutores projects structure. This custom validation attribute enhances consistency and streamlines data management. |

</details>

<details closed><summary>WebAPIAutores.Properties</summary>

| File                                                                                                                       | Summary                                                                                                                                                                                                                                                      |
| ---                                                                                                                        | ---                                                                                                                                                                                                                                                          |
| [launchSettings.json](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Properties/launchSettings.json) | Configures application settings for development environment. Defines URLs for launching and IIS Express setup with Windows Authentication off. Enables hot-reload profile and shows launch browser on execution, directing to Swagger for API documentation. |

</details>

<details closed><summary>WebAPIAutores.Servicios</summary>

| File                                                                                                                                | Summary                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---                                                                                                                                 | ---                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [HashService.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Servicios/HashService.cs)                     | Encrypts user-generated text by utilizing the PBKDF2 hashing algorithm with HMACSHA1, delivering a secure salted hash for data protection within the subscription service infrastructure of this web API project.                                                                                                                                                                                                                                                       |
| [ServicioLlaves.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Servicios/ServicioLlaves.cs)               | Manages and generates unique access keys (Llaves) for specific users within the WebAPIAutores application, facilitating secure interaction with API services. The ServicioLlaves class handles creating new keys based on a predefined type and activating them in the ApplicationDbContext database, ensuring a scalable user authentication system.                                                                                                                   |
| [FacturasHostedService.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Servicios/FacturasHostedService.cs) | This service automates factura processing on daily basis within the subscription management WebAPIAutores. When the application starts, it kicks off a timer that calls `ProcesarFacturas` method at an interval of one day. Inside the method, it checks and sets overdue invoices as malpaid and emits new facturas for the last month if necessary, using the ApplicationDbContext (data access layer) and external stored procedures to interact with the database. |

</details>

<details closed><summary>WebAPIAutores.Utilidades</summary>

| File                                                                                                                           | Summary                                                                                                                                                                                                                                                                                                                    |
| ---                                                                                                                            | ---                                                                                                                                                                                                                                                                                                                        |
| [AutoMapperProfiles.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Utilidades/AutoMapperProfiles.cs) | Streamlines data conversion between DTOs (Data Transfer Objects) and Entities within this APIs architecture. This AutoMapperProfiles class maps Autor, Libro, Comentario, LlaveAPI, RestriccionDominio, and RestriccionIP data types, ensuring consistent data representation and ease of exchange across the application. |

</details>

<details closed><summary>WebAPIAutores.Controllers</summary>

| File                                                                                                                                                    | Summary                                                                                                                                                                                                                                                                                                                                                                                     |
| ---                                                                                                                                                     | ---                                                                                                                                                                                                                                                                                                                                                                                         |
| [CustomBaseController.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Controllers/CustomBaseController.cs)                     | Provides a base controller for handling API requests within WebAPIAutores. The `CustomBaseController` retrieves the unique user ID from the HTTP context claims and makes it available across all controllers to manage authentication.                                                                                                                                                     |
| [LibrosController.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Controllers/LibrosController.cs)                             | Manages API endpoints for interacting with library books within the subscriptions application, including creating, updating, retrieving, and deleting records. It maps between entities (Libro) and their corresponding DTOs, validates inputs using AutoMapper and Microsoft ASP.NET Core, and employs EF Core for database interaction.                                                   |
| [CuentasController.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Controllers/CuentasController.cs)                           | Manages user registration and login via APIs for subscription service. Leverages authentication, data protection, configuration, and Identity libraries to authenticate users using email and password. Issues JSON Web Tokens (JWT) for secure authentication management, granting access for administrative actions such as adding or removing admin roles.                               |
| [RestriccionesIpController.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Controllers/RestriccionesIpController.cs)           | This controller restricts IP access to authorized APIs within the application. It receives and processes HTTP requests (POST, PUT, DELETE) for creating, updating, and deleting IP restrictions, ensuring only authorized users can manage them, utilizing an underlying database context for persistence.                                                                                  |
| [FacturasController.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Controllers/FacturasController.cs)                         | This code within the `FacturasController` accepts incoming POST requests, fetches the corresponding invoice, marks it as paid if not already done, and updates related users late payments status accordingly in the parent repositorys ApplicationDbContext.                                                                                                                               |
| [RestriccionesDominioController.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Controllers/RestriccionesDominioController.cs) | This file **controls** authentication-restricted API endpoints related to domain restrictions in the WebAPIAutores project. It accepts POST, PUT and DELETE requests for managing domain restrictions, ensuring that only authorized users with specified API keys can perform actions.                                                                                                     |
| [LlavesAPIController.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Controllers/LlavesAPIController.cs)                       | Manages API for application-level keys in the repositorys authentication system. Provides endpoints for fetching, creating, and updating keys associated with authenticated users. Integrates with data access, service, and automapper layers within the WebAPIAutores architecture. Enforces authorization through JWT bearer scheme.                                                     |
| [AutoresController.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Controllers/AutoresController.cs)                           | Manages REST API for authors in this project, supporting CRUD (Create, Read, Update, Delete) operations with authentication. Provides data retrieval functionality from the database, using AutoMapper for data mapping and MongoDB as underlying storage.                                                                                                                                  |
| [ComentariosController.cs](https://github.com/juansdev/subscripciones/blob/master/WebAPIAutores/Controllers/ComentariosController.cs)                   | This code controller handles CRUD operations for comment posts related to specific books within the `WebAPIAutores` application. By implementing authorization checks using JWT, it allows users to post comments on specific books and retrieve all or individual book-related comments. The comments are stored in a database and mapped via AutoMapper for easy manipulation by the API. |

</details>

---

##  Getting Started

**System Requirements:**

* **CSharp**: `version 10`
* **.NET**: `version 6`

###  Installation

<h4>From <code>source</code></h4>

> 1. Clone the subscripciones repository:
>
> ```console
> $ git clone https://github.com/juansdev/subscripciones
> ```
>
> 2. Change to the project directory:
> ```console
> $ cd subscripciones
> ```
>
> 3. Install the dependencies:
> ```console
> $ dotnet build
> ```

###  Usage

<h4>From <code>source</code></h4>

> Run subscripciones using the command below:
> ```console
> $ dotnet run
> ```

###  Tests

> Run the test suite using the command below:
> ```console
> $ dotnet test
> ```